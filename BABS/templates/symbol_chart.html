{% extends "base.html" %}

{% block content %}
<div class="content-wrapper">
<!-- Content Header (Page header) -->
  <section class="content-header">
    <div class="container-fluid">
    </div>
  </section>

	<!-- Main content -->
	<section class="content">
		<div class="container-fluid">

      <div class="card"><!-- Charts table -->
				<div class="card-header">
					<h5>
						<i class="fas fa-chart-simple"></i>
						&nbsp;{{ symbol }} chart
					</h5>
				</div>

				<div class="card-body">
          <div style="width: 800px;">
            <canvas id="chart"></canvas>
          </div>
				</div><!-- card body -->
		  </div><!-- card -->

	  </div><!-- container-fluid -->

	</section>
</div><!-- content-wrapper -->

<!-- ChartJs -->
<script>
  "use strict";
$(function () {
  const asks = JSON.parse('{{ asks|safe }}');
  const bids = JSON.parse('{{ bids|safe }}');
  const timestamps = '{{ timestamps|safe }}';

  // timestamps change to more readable format
  const inputDate = new Date(timestamps);
  const outputTimeString = inputDate.toLocaleTimeString();
  const outputDateString = inputDate.toLocaleDateString();
  const date = `${outputTimeString} - ${outputDateString} ${inputDate.toLocaleTimeString('en-us', { timeZoneName: 'short' })}`;

  const ctx = document.getElementById('chart');

  new Chart(ctx, {
    type: 'scatter',
    options: {
      plugins: {
        title: {
          display: true,
          text: date,
        }
      }
    },
    data: {
    datasets: [{
      label: 'Asks',
      data: asks,
      borderColor: 'red',
      backgroundColor: 'rgba(255, 0, 0, 0.5)',
      borderWidth: 1,
    },
    {
      label: 'Bids',
      data: bids,
      borderColor: 'green',
      backgroundColor: 'rgba(0, 255, 0, 0.5)',
      borderWidth: 1,
    }]
  }
  });


});
</script>
{% endblock %}
